# 2.3 实践练习

## 练习目标
- 巩固面向对象和函数式编程类型支持知识
- 通过实际编程练习提升类型设计能力
- 培养面向对象和函数式编程思维
- 为后续学习打下坚实基础

## 练习项目：类型安全的电商系统

### 项目描述
创建一个类型安全的电商系统，包含商品管理、购物车、订单处理等功能。通过这个项目，你将练习使用TypeScript的面向对象和函数式编程特性。

### 项目结构
```
ecommerce-system/
├── src/
│   ├── types/
│   │   ├── product.ts
│   │   ├── cart.ts
│   │   ├── order.ts
│   │   └── user.ts
│   ├── models/
│   │   ├── Product.ts
│   │   ├── Cart.ts
│   │   ├── Order.ts
│   │   └── User.ts
│   ├── services/
│   │   ├── ProductService.ts
│   │   ├── CartService.ts
│   │   └── OrderService.ts
│   ├── utils/
│   │   ├── functional.ts
│   │   └── validation.ts
│   └── index.ts
├── tests/
│   └── type-tests.ts
└── package.json
```

## 练习1：面向对象编程

### 任务1.1：商品模型设计
```typescript
// src/types/product.ts
// 任务：设计商品相关的类型和接口

// 1. 定义商品接口
interface Product {
  // 你的实现
}

// 2. 定义商品类别枚举
enum ProductCategory {
  // 你的实现
}

// 3. 定义商品状态类型
type ProductStatus = /* 你的实现 */;

// 4. 定义商品属性接口
interface ProductAttributes {
  // 你的实现
}

// 5. 定义商品变体接口
interface ProductVariant {
  // 你的实现
}
```

### 任务1.2：商品类实现
```typescript
// src/models/Product.ts
// 任务：实现商品类

// 1. 定义抽象商品基类
abstract class BaseProduct {
  // 你的实现
}

// 2. 实现具体商品类
class Product extends BaseProduct {
  // 你的实现
}

// 3. 实现商品变体类
class ProductVariant extends BaseProduct {
  // 你的实现
}

// 4. 实现商品工厂类
class ProductFactory {
  // 你的实现
}

// 5. 实现商品构建器类
class ProductBuilder {
  // 你的实现
}
```

### 任务1.3：购物车模型设计
```typescript
// src/types/cart.ts
// 任务：设计购物车相关的类型

// 1. 定义购物车项目接口
interface CartItem {
  // 你的实现
}

// 2. 定义购物车接口
interface Cart {
  // 你的实现
}

// 3. 定义购物车操作类型
type CartOperation = /* 你的实现 */;

// 4. 定义购物车事件类型
type CartEvent = /* 你的实现 */;
```

### 任务1.4：购物车类实现
```typescript
// src/models/Cart.ts
// 任务：实现购物车类

// 1. 实现购物车类
class Cart {
  // 你的实现
}

// 2. 实现购物车观察者接口
interface CartObserver {
  // 你的实现
}

// 3. 实现购物车主题类
class CartSubject {
  // 你的实现
}

// 4. 实现购物车策略接口
interface CartStrategy {
  // 你的实现
}

// 5. 实现具体策略类
class StandardCartStrategy implements CartStrategy {
  // 你的实现
}

class PremiumCartStrategy implements CartStrategy {
  // 你的实现
}
```

## 练习2：函数式编程

### 任务2.1：函数式工具实现
```typescript
// src/utils/functional.ts
// 任务：实现函数式编程工具

// 1. 实现Maybe类型
class Maybe<T> {
  // 你的实现
}

// 2. 实现Either类型
class Either<L, R> {
  // 你的实现
}

// 3. 实现函数组合工具
function compose<A, B, C>(
  f: (b: B) => C,
  g: (a: A) => B
): (a: A) => C {
  // 你的实现
}

// 4. 实现管道工具
function pipe<A, B, C>(
  a: A,
  f: (a: A) => B,
  g: (b: B) => C
): C {
  // 你的实现
}

// 5. 实现柯里化工具
function curry<A extends any[], R>(
  fn: (...args: A) => R
): Curry<A, R> {
  // 你的实现
}
```

### 任务2.2：函数式数组操作
```typescript
// 任务：实现函数式数组操作

// 1. 实现函数式数组类
class FunctionalArray<T> {
  // 你的实现
}

// 2. 实现数组操作函数
const map = <T, U>(fn: (item: T) => U) => (array: T[]): U[] => {
  // 你的实现
};

const filter = <T>(predicate: (item: T) => boolean) => (array: T[]): T[] => {
  // 你的实现
};

const reduce = <T, U>(
  reducer: (acc: U, item: T) => U,
  initial: U
) => (array: T[]): U => {
  // 你的实现
};

// 3. 实现数组组合操作
const compose = <T, U, V>(
  f: (array: U[]) => V[],
  g: (array: T[]) => U[]
) => (array: T[]): V[] => {
  // 你的实现
};
```

### 任务2.3：函数式验证
```typescript
// src/utils/validation.ts
// 任务：实现函数式验证系统

// 1. 定义验证规则类型
type ValidationRule<T> = {
  // 你的实现
};

// 2. 定义验证结果类型
type ValidationResult<T> = {
  // 你的实现
};

// 3. 实现验证器类
class Validator<T> {
  // 你的实现
}

// 4. 实现验证组合器
function combineValidators<T>(
  validators: Validator<T>[]
): Validator<T> {
  // 你的实现
}

// 5. 实现验证管道
function validate<T>(
  value: T,
  validator: Validator<T>
): ValidationResult<T> {
  // 你的实现
}
```

## 练习3：服务层设计

### 任务3.1：商品服务实现
```typescript
// src/services/ProductService.ts
// 任务：实现商品服务

// 1. 定义商品服务接口
interface ProductService {
  // 你的实现
}

// 2. 实现商品服务类
class ProductServiceImpl implements ProductService {
  // 你的实现
}

// 3. 实现商品缓存装饰器
function withCache<T extends (...args: any[]) => any>(
  fn: T,
  cache: Map<string, any>
): T {
  // 你的实现
}

// 4. 实现商品日志装饰器
function withLogging<T extends (...args: any[]) => any>(
  fn: T
): T {
  // 你的实现
}

// 5. 实现商品重试装饰器
function withRetry<T extends (...args: any[]) => any>(
  fn: T,
  maxRetries: number
): T {
  // 你的实现
}
```

### 任务3.2：购物车服务实现
```typescript
// src/services/CartService.ts
// 任务：实现购物车服务

// 1. 定义购物车服务接口
interface CartService {
  // 你的实现
}

// 2. 实现购物车服务类
class CartServiceImpl implements CartService {
  // 你的实现
}

// 3. 实现购物车中间件
type CartMiddleware<T> = (context: T, next: () => void) => void;

// 4. 实现购物车中间件管道
class CartMiddlewarePipeline<T> {
  // 你的实现
}

// 5. 实现购物车事件处理器
class CartEventHandler {
  // 你的实现
}
```

## 练习4：综合应用

### 任务4.1：订单处理系统
```typescript
// src/types/order.ts
// 任务：设计订单处理系统

// 1. 定义订单接口
interface Order {
  // 你的实现
}

// 2. 定义订单状态枚举
enum OrderStatus {
  // 你的实现
}

// 3. 定义订单处理步骤类型
type OrderStep = /* 你的实现 */;

// 4. 定义订单处理器接口
interface OrderProcessor {
  // 你的实现
}

// 5. 定义订单验证器接口
interface OrderValidator {
  // 你的实现
}
```

### 任务4.2：订单服务实现
```typescript
// src/services/OrderService.ts
// 任务：实现订单服务

// 1. 实现订单服务类
class OrderService {
  // 你的实现
}

// 2. 实现订单状态机
class OrderStateMachine {
  // 你的实现
}

// 3. 实现订单工作流
class OrderWorkflow {
  // 你的实现
}

// 4. 实现订单事件总线
class OrderEventBus {
  // 你的实现
}

// 5. 实现订单补偿机制
class OrderCompensation {
  // 你的实现
}
```

## 练习5：测试和验证

### 任务5.1：类型测试
```typescript
// tests/type-tests.ts
// 任务：编写类型测试

// 1. 测试商品类型
type ProductTest = {
  // 测试用例
};

// 2. 测试购物车类型
type CartTest = {
  // 测试用例
};

// 3. 测试订单类型
type OrderTest = {
  // 测试用例
};

// 4. 测试服务类型
type ServiceTest = {
  // 测试用例
};

// 5. 测试函数式编程类型
type FunctionalTest = {
  // 测试用例
};
```

### 任务5.2：集成测试
```typescript
// 任务：编写集成测试

// 1. 测试商品服务集成
function testProductServiceIntegration() {
  // 你的实现
}

// 2. 测试购物车服务集成
function testCartServiceIntegration() {
  // 你的实现
}

// 3. 测试订单服务集成
function testOrderServiceIntegration() {
  // 你的实现
}

// 4. 测试完整业务流程
function testCompleteWorkflow() {
  // 你的实现
}
```

## 作业要求

### 基础要求
1. 完成所有类型定义和类实现
2. 确保类型安全性
3. 添加适当的注释和文档
4. 通过TypeScript编译检查

### 进阶要求
1. 使用设计模式
2. 实现函数式编程特性
3. 创建可复用的组件
4. 实现完整的测试覆盖

### 提交要求
1. 完整的TypeScript代码
2. 类型测试文件
3. 学习笔记和总结
4. 遇到的问题和解决方案

## 学习检查点

- [ ] 完成面向对象编程练习
- [ ] 实现函数式编程特性
- [ ] 创建类型安全的服务层
- [ ] 编写完整的测试
- [ ] 通过所有TypeScript编译检查

## 下一步学习

完成本部分练习后，请继续学习 [3.1 模块系统和声明文件](../week3/3.1-module-system.md)。
