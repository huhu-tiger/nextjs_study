# 3.3 实践练习

## 练习目标
- 巩固模块系统和现代JavaScript特性知识
- 通过实际编程练习提升模块设计能力
- 培养现代JavaScript编程思维
- 为后续学习打下坚实基础

## 练习项目：类型安全的模块化应用

### 项目描述
创建一个类型安全的模块化应用，包含用户管理、数据验证、错误处理等功能。通过这个项目，你将练习使用TypeScript的模块系统和现代JavaScript特性。

### 项目结构
```
modular-app/
├── src/
│   ├── types/
│   │   ├── index.ts
│   │   ├── user.ts
│   │   ├── api.ts
│   │   └── validation.ts
│   ├── modules/
│   │   ├── user/
│   │   │   ├── index.ts
│   │   │   ├── UserService.ts
│   │   │   ├── UserRepository.ts
│   │   │   └── UserController.ts
│   │   ├── auth/
│   │   │   ├── index.ts
│   │   │   ├── AuthService.ts
│   │   │   └── AuthMiddleware.ts
│   │   └── validation/
│   │       ├── index.ts
│   │       ├── Validator.ts
│   │       └── Rules.ts
│   ├── utils/
│   │   ├── index.ts
│   │   ├── errorHandler.ts
│   │   ├── logger.ts
│   │   └── helpers.ts
│   ├── config/
│   │   ├── index.ts
│   │   └── database.ts
│   └── app.ts
├── tests/
│   ├── modules/
│   └── integration/
├── types/
│   └── global.d.ts
└── package.json
```

## 练习1：模块系统设计

### 任务1.1：类型定义模块
```typescript
// src/types/user.ts
// 任务：设计用户相关的类型定义

// 1. 定义用户基础接口
export interface User {
  // 你的实现
}

// 2. 定义用户创建请求接口
export interface CreateUserRequest {
  // 你的实现
}

// 3. 定义用户更新请求接口
export interface UpdateUserRequest {
  // 你的实现
}

// 4. 定义用户查询选项接口
export interface UserQueryOptions {
  // 你的实现
}

// 5. 定义用户响应接口
export interface UserResponse {
  // 你的实现
}
```

### 任务1.2：API类型定义
```typescript
// src/types/api.ts
// 任务：设计API相关的类型定义

// 1. 定义基础API响应接口
export interface ApiResponse<T> {
  // 你的实现
}

// 2. 定义分页响应接口
export interface PaginatedResponse<T> {
  // 你的实现
}

// 3. 定义API错误接口
export interface ApiError {
  // 你的实现
}

// 4. 定义API端点类型
export type ApiEndpoint = /* 你的实现 */;

// 5. 定义API客户端接口
export interface ApiClient {
  // 你的实现
}
```

### 任务1.3：验证类型定义
```typescript
// src/types/validation.ts
// 任务：设计验证相关的类型定义

// 1. 定义验证规则接口
export interface ValidationRule<T> {
  // 你的实现
}

// 2. 定义验证结果接口
export interface ValidationResult<T> {
  // 你的实现
}

// 3. 定义验证器接口
export interface Validator<T> {
  // 你的实现
}

// 4. 定义字段验证接口
export interface FieldValidation {
  // 你的实现
}

// 5. 定义表单验证接口
export interface FormValidation<T> {
  // 你的实现
}
```

## 练习2：模块实现

### 任务2.1：用户模块实现
```typescript
// src/modules/user/UserService.ts
// 任务：实现用户服务模块

// 1. 定义用户服务接口
export interface IUserService {
  // 你的实现
}

// 2. 实现用户服务类
export class UserService implements IUserService {
  // 你的实现
}

// 3. 实现用户仓库接口
export interface IUserRepository {
  // 你的实现
}

// 4. 实现用户仓库类
export class UserRepository implements IUserRepository {
  // 你的实现
}

// 5. 实现用户控制器类
export class UserController {
  // 你的实现
}
```

### 任务2.2：认证模块实现
```typescript
// src/modules/auth/AuthService.ts
// 任务：实现认证服务模块

// 1. 定义认证服务接口
export interface IAuthService {
  // 你的实现
}

// 2. 实现认证服务类
export class AuthService implements IAuthService {
  // 你的实现
}

// 3. 实现认证中间件类
export class AuthMiddleware {
  // 你的实现
}

// 4. 实现JWT工具类
export class JwtUtils {
  // 你的实现
}

// 5. 实现密码工具类
export class PasswordUtils {
  // 你的实现
}
```

### 任务2.3：验证模块实现
```typescript
// src/modules/validation/Validator.ts
// 任务：实现验证模块

// 1. 定义验证器基类
export abstract class BaseValidator<T> {
  // 你的实现
}

// 2. 实现用户验证器
export class UserValidator extends BaseValidator<User> {
  // 你的实现
}

// 3. 实现认证验证器
export class AuthValidator extends BaseValidator<CreateUserRequest> {
  // 你的实现
}

// 4. 实现验证规则类
export class ValidationRules {
  // 你的实现
}

// 5. 实现验证工厂类
export class ValidatorFactory {
  // 你的实现
}
```

## 练习3：工具模块实现

### 任务3.1：错误处理模块
```typescript
// src/utils/errorHandler.ts
// 任务：实现错误处理模块

// 1. 定义错误类型枚举
export enum ErrorType {
  // 你的实现
}

// 2. 定义自定义错误类
export class AppError extends Error {
  // 你的实现
}

// 3. 实现错误处理器类
export class ErrorHandler {
  // 你的实现
}

// 4. 实现错误日志记录器
export class ErrorLogger {
  // 你的实现
}

// 5. 实现错误恢复策略
export class ErrorRecovery {
  // 你的实现
}
```

### 任务3.2：日志模块实现
```typescript
// src/utils/logger.ts
// 任务：实现日志模块

// 1. 定义日志级别枚举
export enum LogLevel {
  // 你的实现
}

// 2. 定义日志接口
export interface ILogger {
  // 你的实现
}

// 3. 实现控制台日志记录器
export class ConsoleLogger implements ILogger {
  // 你的实现
}

// 4. 实现文件日志记录器
export class FileLogger implements ILogger {
  // 你的实现
}

// 5. 实现日志管理器
export class LoggerManager {
  // 你的实现
}
```

### 任务3.3：辅助工具模块
```typescript
// src/utils/helpers.ts
// 任务：实现辅助工具模块

// 1. 实现字符串工具类
export class StringUtils {
  // 你的实现
}

// 2. 实现日期工具类
export class DateUtils {
  // 你的实现
}

// 3. 实现对象工具类
export class ObjectUtils {
  // 你的实现
}

// 4. 实现数组工具类
export class ArrayUtils {
  // 你的实现
}

// 5. 实现函数工具类
export class FunctionUtils {
  // 你的实现
}
```

## 练习4：配置模块实现

### 任务4.1：应用配置
```typescript
// src/config/index.ts
// 任务：实现应用配置模块

// 1. 定义配置接口
export interface AppConfig {
  // 你的实现
}

// 2. 实现配置加载器
export class ConfigLoader {
  // 你的实现
}

// 3. 实现配置验证器
export class ConfigValidator {
  // 你的实现
}

// 4. 实现配置管理器
export class ConfigManager {
  // 你的实现
}

// 5. 实现环境配置
export class EnvironmentConfig {
  // 你的实现
}
```

### 任务4.2：数据库配置
```typescript
// src/config/database.ts
// 任务：实现数据库配置模块

// 1. 定义数据库配置接口
export interface DatabaseConfig {
  // 你的实现
}

// 2. 实现数据库连接管理器
export class DatabaseConnectionManager {
  // 你的实现
}

// 3. 实现数据库迁移工具
export class DatabaseMigration {
  // 你的实现
}

// 4. 实现数据库健康检查
export class DatabaseHealthCheck {
  // 你的实现
}
```

## 练习5：现代JavaScript特性应用

### 任务5.1：异步操作优化
```typescript
// 任务：使用现代JavaScript特性优化异步操作

// 1. 使用顶层await优化模块加载
const config = await import('./config');
const logger = await import('./utils/logger');

// 2. 使用Promise.allSettled处理多个异步操作
export class AsyncOperationManager {
  // 你的实现
}

// 3. 使用async/await优化错误处理
export class AsyncErrorHandler {
  // 你的实现
}

// 4. 使用现代数组方法处理数据
export class DataProcessor {
  // 你的实现
}
```

### 任务5.2：正则表达式应用
```typescript
// 任务：使用现代正则表达式特性

// 1. 实现URL验证器
export class UrlValidator {
  // 你的实现
}

// 2. 实现邮箱提取器
export class EmailExtractor {
  // 你的实现
}

// 3. 实现密码强度检查器
export class PasswordStrengthChecker {
  // 你的实现
}

// 4. 实现数据清理器
export class DataSanitizer {
  // 你的实现
}
```

## 练习6：集成测试

### 任务6.1：模块集成测试
```typescript
// tests/modules/user.test.ts
// 任务：编写用户模块集成测试

describe('User Module Integration', () => {
  // 1. 测试用户服务集成
  test('should create user successfully', async () => {
    // 你的实现
  });

  // 2. 测试用户验证集成
  test('should validate user data correctly', async () => {
    // 你的实现
  });

  // 3. 测试错误处理集成
  test('should handle errors gracefully', async () => {
    // 你的实现
  });
});
```

### 任务6.2：端到端测试
```typescript
// tests/integration/app.test.ts
// 任务：编写端到端测试

describe('Application E2E', () => {
  // 1. 测试完整用户流程
  test('should handle complete user flow', async () => {
    // 你的实现
  });

  // 2. 测试错误恢复流程
  test('should recover from errors', async () => {
    // 你的实现
  });

  // 3. 测试性能表现
  test('should meet performance requirements', async () => {
    // 你的实现
  });
});
```

## 作业要求

### 基础要求
1. 完成所有模块定义和实现
2. 确保模块间的类型安全
3. 添加适当的注释和文档
4. 通过TypeScript编译检查

### 进阶要求
1. 使用现代JavaScript特性
2. 实现完整的错误处理
3. 创建可复用的模块
4. 实现完整的测试覆盖

### 提交要求
1. 完整的TypeScript代码
2. 模块化项目结构
3. 集成测试文件
4. 学习笔记和总结

## 学习检查点

- [ ] 完成模块系统设计
- [ ] 实现现代JavaScript特性
- [ ] 创建类型安全的模块
- [ ] 编写完整的测试
- [ ] 通过所有TypeScript编译检查

## 下一步学习

完成本部分练习后，请继续学习 [4.1 综合项目](../week4/4.1-comprehensive-project.md)。
