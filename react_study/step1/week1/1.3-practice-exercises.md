# 1.3 实践练习

## 练习目标
- 巩固TypeScript 5.x核心特性知识
- 通过实际编程练习提升类型编程能力
- 培养类型安全编程思维
- 为后续学习打下坚实基础

## 练习项目：类型安全的用户管理系统

### 项目描述
创建一个类型安全的用户管理系统，包含用户注册、登录、权限管理等功能。通过这个项目，你将练习使用TypeScript的各种高级特性。

### 项目结构
```
user-management-system/
├── src/
│   ├── types/
│   │   ├── user.ts
│   │   ├── auth.ts
│   │   └── api.ts
│   ├── utils/
│   │   ├── validation.ts
│   │   └── helpers.ts
│   ├── services/
│   │   ├── userService.ts
│   │   └── authService.ts
│   └── index.ts
├── tests/
│   └── type-tests.ts
└── package.json
```

## 练习1：基础类型定义

### 任务1.1：用户类型定义
```typescript
// src/types/user.ts
// 任务：定义用户相关的类型

// 1. 定义基础用户接口
interface User {
  // 你的实现
}

// 2. 定义用户角色枚举
enum UserRole {
  // 你的实现
}

// 3. 定义用户状态联合类型
type UserStatus = /* 你的实现 */;

// 4. 定义用户权限类型
type UserPermissions = /* 你的实现 */;

// 5. 创建用户创建时的类型（排除 id 和 createdAt）
type CreateUserInput = /* 你的实现 */;

// 6. 创建用户更新时的类型（所有字段可选）
type UpdateUserInput = /* 你的实现 */;
```

### 任务1.2：认证类型定义
```typescript
// src/types/auth.ts
// 任务：定义认证相关的类型

// 1. 定义登录请求类型
interface LoginRequest {
  // 你的实现
}

// 2. 定义注册请求类型
interface RegisterRequest {
  // 你的实现
}

// 3. 定义认证响应类型
interface AuthResponse {
  // 你的实现
}

// 4. 定义JWT载荷类型
interface JwtPayload {
  // 你的实现
}

// 5. 定义权限检查类型
type PermissionCheck<T extends UserRole> = /* 你的实现 */;
```

## 练习2：高级类型编程

### 任务2.1：API响应类型
```typescript
// src/types/api.ts
// 任务：创建类型安全的API响应系统

// 1. 定义基础API响应类型
interface ApiResponse<T> {
  // 你的实现
}

// 2. 定义分页响应类型
interface PaginatedResponse<T> {
  // 你的实现
}

// 3. 定义错误响应类型
interface ApiError {
  // 你的实现
}

// 4. 创建API端点类型映射
type ApiEndpoints = {
  // 你的实现
};

// 5. 创建API客户端类型
type ApiClient = {
  // 你的实现
};
```

### 任务2.2：验证工具类型
```typescript
// src/utils/validation.ts
// 任务：创建类型安全的验证系统

// 1. 定义验证规则类型
type ValidationRule<T> = {
  // 你的实现
};

// 2. 定义验证结果类型
type ValidationResult<T> = {
  // 你的实现
};

// 3. 创建验证器类型
type Validator<T> = {
  // 你的实现
};

// 4. 创建表单验证类型
type FormValidation<T> = {
  // 你的实现
};
```

## 练习3：服务层类型设计

### 任务3.1：用户服务类型
```typescript
// src/services/userService.ts
// 任务：创建类型安全的用户服务

// 1. 定义用户服务接口
interface UserService {
  // 你的实现
}

// 2. 定义用户查询选项类型
type UserQueryOptions = {
  // 你的实现
};

// 3. 定义用户排序选项类型
type UserSortOptions = {
  // 你的实现
};

// 4. 创建用户服务实现类
class UserServiceImpl implements UserService {
  // 你的实现
}
```

### 任务3.2：认证服务类型
```typescript
// src/services/authService.ts
// 任务：创建类型安全的认证服务

// 1. 定义认证服务接口
interface AuthService {
  // 你的实现
}

// 2. 定义密码策略类型
type PasswordPolicy = {
  // 你的实现
};

// 3. 定义会话管理类型
type SessionManager<T extends UserRole> = {
  // 你的实现
};

// 4. 创建认证服务实现类
class AuthServiceImpl implements AuthService {
  // 你的实现
}
```

## 练习4：工具函数类型设计

### 任务4.1：类型守卫函数
```typescript
// src/utils/helpers.ts
// 任务：创建类型安全的工具函数

// 1. 创建用户类型守卫
function isUser(obj: unknown): obj is User {
  // 你的实现
}

// 2. 创建管理员类型守卫
function isAdmin(user: User): user is User & { role: UserRole.Admin } {
  // 你的实现
}

// 3. 创建有效邮箱类型守卫
function isValidEmail(email: string): email is `${string}@${string}.${string}` {
  // 你的实现
}

// 4. 创建安全密码类型守卫
function isSecurePassword(password: string): password is string {
  // 你的实现
}
```

### 任务4.2：类型转换函数
```typescript
// 任务：创建类型安全的转换函数

// 1. 创建用户转换函数
function transformUser<T extends User>(user: T): /* 你的返回类型 */ {
  // 你的实现
}

// 2. 创建权限检查函数
function checkPermission<T extends UserRole>(
  user: User,
  requiredRole: T
): user is User & { role: T } {
  // 你的实现
}

// 3. 创建数据验证函数
function validateUserData<T extends CreateUserInput>(
  data: unknown
): data is T {
  // 你的实现
}
```

## 练习5：综合应用

### 任务5.1：类型安全的表单处理
```typescript
// 任务：创建一个类型安全的表单处理系统

// 1. 定义表单字段类型
type FormField<T> = {
  // 你的实现
};

// 2. 定义表单状态类型
type FormState<T> = {
  // 你的实现
};

// 3. 定义表单验证器类型
type FormValidator<T> = {
  // 你的实现
};

// 4. 创建表单处理器类
class FormHandler<T> {
  // 你的实现
}
```

### 任务5.2：事件系统类型设计
```typescript
// 任务：创建一个类型安全的事件系统

// 1. 定义事件映射类型
type EventMap = {
  // 你的实现
};

// 2. 定义事件监听器类型
type EventListener<T> = {
  // 你的实现
};

// 3. 定义事件发射器类型
type EventEmitter<T extends EventMap> = {
  // 你的实现
};

// 4. 创建事件管理器类
class EventManager<T extends EventMap> {
  // 你的实现
}
```

## 测试练习

### 任务6：类型测试
```typescript
// tests/type-tests.ts
// 任务：编写类型测试确保类型正确性

// 1. 测试用户类型
type UserTest = {
  // 测试用例
};

// 2. 测试API响应类型
type ApiResponseTest = {
  // 测试用例
};

// 3. 测试验证类型
type ValidationTest = {
  // 测试用例
};

// 4. 测试服务类型
type ServiceTest = {
  // 测试用例
};
```

## 作业要求

### 基础要求
1. 完成所有类型定义
2. 确保类型安全性
3. 添加适当的注释
4. 通过TypeScript编译检查

### 进阶要求
1. 使用高级类型特性
2. 创建可复用的类型工具
3. 实现完整的类型测试
4. 优化类型性能

### 提交要求
1. 完整的TypeScript代码
2. 类型测试文件
3. 学习笔记和总结
4. 遇到的问题和解决方案

## 学习检查点

- [ ] 完成所有基础类型定义
- [ ] 实现高级类型编程练习
- [ ] 创建类型安全的服务层
- [ ] 编写类型测试
- [ ] 通过所有TypeScript编译检查

## 下一步学习

完成本部分练习后，请继续学习 [2.1 面向对象编程类型支持](../week2/2.1-oop-types.md)。
